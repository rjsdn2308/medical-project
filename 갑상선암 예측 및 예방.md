## 갑상선암 예측 및 예방

## 1. 프로젝트 개요
- **프로젝트 이름** : 갑상선암 예측 및 예방
- **작성자** : 김건우
- **작성일** : 2025년 03월 30일

## 2. 배경 및 필요성
- 갑상선암은 국내 여성에게서 특히 많이 발생하는 암으로, 발생율은 높지만 생존율이 비교적 높습니다.
- 조기 발견 시 치료 성과가 매우 우수하므로, 정확하고 빠른 예측이 무엇보다 중요합니다.
- 기존 진단 방식은 의료진의 경험과 정해진 지표에 의존해왔으나, 이는 복합적인 예측이 어렵고 재발 위험까지 고려하기 어렵습니다.
- 머신러닝 기술을 활용한 의료 데이터 분석은 정밀한 예측을 가능하게 하며 예방 중심의 의료 시스템으로 전환하는데 중요한 역할을 합니다. 

## 3. 프로젝트의 목표
- 환자의 의료 데이터를 기반으로 갑상선암의 위험 요인을 분석하고, 예측 모델을 개발하여 조기 진단을 돕습니다.
- 나아가 환자 맞춤형 치료 전략 수립 및 재발 가능성 평가를 지원할 수 있는 머신러닝 기반 솔루션을 구현하는 것입니다. 

## 4. 프로젝트의 주요 기능 특징
- 환자 데이터 수집 : 갑상선암과 관련된 환자의 의료 기록, 검사 결과, 유전자 정보, 생활습관 데이터 등을 수집하는 것입니다.
   - 데이터 : 결측치 처리, 데이터 정규화, 이상치 제거 등 데이터 품질을 향상하시키는 작업
   - 변수 분석 : 다영한 변수들이 갑상선암 발병에 미치는 영향을 분석
- 머신러닝 알고리즘 활용 : 나이, 성별, 가족력, 호르몬 수치 증 다양한 특성을 기반으로 갑상성암을 예측하는 모델을 개발하는 것입니다.
   - 기계학습 모델 훈련 : 기존 환자 데이터를 사용하여 예측 모델을 훈련하고, 모델의 정확도를 평가하는 것입니다. 
   - 모델 최적화 : 다양한 하이퍼파라미터 튜닝을 통해 모델 성능을 최적화합니다.

## 5. 데이터셋 및 데이터셋에 대한 설명 
- Thyroid Cancer Prediction 🩺(Recurrence) EDA + ANN[https://www.kaggle.com/code/vizeno/thyroid-cancer-prediction-recurrence-eda-ann/input] 

－ | 항목                   | 설명                                                   |

 | 🔢 **총 행(Row) 수**    | 2436개 샘플 (siRNA 서열 + 효율값)                            |

 | 📊 **총 열(Column) 수** | 개 컬럼                                                |

 | 열 이름                 | 설명                                                   |

 | Age            | 환자의 나이[단위 : 세]                                               |

 | Gender             | 환자의 성별[남성 또는 여성]                                               |

 | Tumor Size             | 종양의 크기[단윈 : mm]                                          |

 | Histologic Type             | 조직학적 유형[ex) 유두암, 여포암 등]                                               |

 | Lymph Node Metastasis             | 림프절 전이 여부[ex) 있음 또는 없음]                                               |

 | Extrathyroidal Extension             | 갑상선 외 침습 여부                                               |

 | Distant Metastasis             | 원격 전이 여부                                               |

 | TNM Stage             | 종양의 병기[Tumor, Node, Metastasis]                                               |

 | Surgical Treatment            | 수술 치료 여부                                               |

 | Radioactive Iodine Therapy           | 방사성 요오드 치료 여부                                               |

 | TSH Suppression Therapy             | 갑상선 자극 호르몬 억제 치료 여부                                               |

 | Follow-up Duration             | 추적 관찰 기관 [단위 : 개월]                                               |

 | Recurrence            | 재발 여부[ex) 재발 또는 비재발]                                               |

 | `seq`                | 21개 염기로 구성된 siRNA 염기 서열 (예: "GAGCUUUCAUGAAGUACAGAA") |

 | `Label`              | 실험을 통해 측정된 RNAi 효율값 (실수형, 0\~1 사이의 값)                |

- 입력 데이터로는 column 383[행]x17[열]
- 데이터 용량으로는 43.59KB 입니다.

## 6－１. 데이터 알고리즘 선정
－ *DecisionTreeClassifier 모델**
| 구분           | 설명                                                                      |

| **기술 종류**    | 머신러닝                                                                    |

| **모델 이름**    | Decision Tree Classifier (결정 트리 분류기)                                    |

| **라이브러리 예시** | `sklearn.tree.DecisionTreeClassifier`                                   |

| **작동 방식**    | 데이터를 기준(feature)으로 분할하여 예측. 분기가 생긴 나무 구조(tree)를 따라가며 분류                 |

| **딥러닝과 차이점** | 딥러닝은 인공신경망 기반으로, 대량의 데이터를 통해 계층적 패턴을 학습함. 결정 트리는 그런 층이 없고, 규칙 기반 분할이 핵심 |

| **해석 용이성 (Interpretability)** | 예측 과정을 나무 구조로 시각화 가능. "왜 이 결과가 나왔는지" 설명할 수 있음 |

| **전처리 부담이 적음**                | 스케일링, 정규화 등 데이터 전처리에 덜 민감함                    |

| **범주형/숫자형 혼합 데이터에 강함**        | 라벨 인코딩만 해주면 잘 작동함                             |

| **빠른 학습 속도**                  | 작은/중간 규모 데이터에 매우 빠름                           |

| **결측값/이상치에 상대적으로 견고**         | 다른 모델에 비해 어느 정도 처리 가능                         |

| **특성 선택 자동화**                 | 모델이 자동으로 중요한 특성을 판단함 (feature importance)     |

## 6－２. 모델 선정 후 실행 
| 단계         | 설명                                           |
| ---------- | -------------------------------------------- |
| 1️⃣ 데이터 로딩 | `Thyroid_Diff.csv` 불러오기                      |
| 2️⃣ 전처리    | 문자열 컬럼 → `LabelEncoder`로 숫자 변환               |
| 3️⃣ 반복 처리  | 각 컬럼을 예측 대상으로 순차 설정                          |
| 4️⃣ 스케일링   | 나머지 컬럼들에 `StandardScaler` 적용                 |
| 5️⃣ 모델 훈련  | `DecisionTreeClassifier`로 훈련                 |
| 6️⃣ 평가     | `accuracy_score`, `classification_report` 출력 |

## 7-1. 데이터 전처리 과정  
# 7-ⅰ. 데이터 불러오기
     - 연구나 분석에 사용할 **갑상선암 관련 데이터(Thyroid_Diff.csv)**를 불러옵니다.
     - 이 파일은 CSV 형식이며, 표 형식의 데이터로 구성되어 있습니다.

# 7-ⅱ. 문자열 데이터 숫자로 변환(라벨 인코딩)
     - 데이터에 포함된 문자 형테의 정보 [ex) 성별, 진단명 등]는 컴퓨터로는 이해하기 어렵습니다. 
     - 그래서 LabelEncoder라는 도구를 사용해 이들을 숫자 값으로 바꿉니다. 
       - ex) '남성' → 0, '여성' → 1

# 7-ⅲ. 데이터 정규화 (스케일링)
     - 모델이 학습하기 쉬운 형태로 만들기 위해 **숫자 값들을 일정한 범위**로 맞춰줍니다.  
     - 데이터들 간의 단위 차이로 인해 모델이 영향을 받지 않도록 하기 위함입니다. 

# 7-ⅳ. 학습용과 테스트용 데이터로 나누기
     - 전체 데이터를 무작위로 나눠서
       - 80%는 학습에 사용
       - 20%는 테스트에 사용

     - 모델이 실제로 잘 작동하는지 평가하기 위함입니다. 

# 7-ⅴ. 각 컬럼을 번갈아가며 예측해보기
      - 데이테의 모든 컬럼 [ex) 나이, 성별, 혈액 수치 등]을 하나씩 **예측 대상(정답)**으로 설정합니다. 
      - 나머지 컬름들은 **입력값(특징)**으로 사용해서 모델을 학습합니다.
      - ex) 
        - "성별을 다른 모든 값으로 예측"
        - "TSH 수치를 나머지 정보를 바탕으로 예측"
      - 이 과정을 모든 컬럼에 대해 반복을 합니다. 
      - 모델은 의사결정트리( Decision Tree) 알고리즘을 사용합니다. 

# 7-ⅵ 데이터 전처리 요약 
       1. 결측값 확인 : 없음
       2. 서열 인코딩 : A, C, G, T → 숫자 또는 One-hot 벡터
       3. 정규화 불필요 : Label이 0~1 범위
       4. 데이터 분할 : 학습 80%, 테스트 20%
       5. 변환기(transformer) : NormalizationTransformer 사용 
       
## 8. 추후 수정 및 추가 
| 구분                | 내용                                    | 설명                                             |
| ----------------- | ------------------------------------- | ---------------------------------------------- |
| 🔁 1. 알고리즘 다양화    | `RandomForest`, `KNN`, `XGBoost` 등 추가 | 모델 비교 가능                                       |
| 🔀 2. 회귀/분류 자동 분기 | `Age` 같이 연속형 변수는 회귀 모델 사용             | 예: `LinearRegression`, `RandomForestRegressor` |
| 📈 3. 성능 시각화      | 정확도 비교 그래프, 혼동 행렬 추가                  | 시각적 이해도 향상                                     |
| 📂 4. 결과 저장       | 정확도/리포트 CSV 저장                        | 모델별 성능 관리                                      |
| 📋 5. 하이퍼파라미터 튜닝  | `GridSearchCV`, `RandomSearchCV` 활용   | 성능 최적화                                         |
| ✅ 6. 이상치 탐지 및 제거  | 스케일링 전 데이터 품질 점검                      | 모델 안정성 향상                                      |
| 🧠 7. 모델 저장/불러오기  | `joblib` 또는 `pickle` 사용               | 나중에 재사용 가능                                     |
| 🌐 8. 웹 앱 배포 (선택) | `Streamlit` 또는 `Flask` 활용             | 사용자 입력 받아 예측                                   |

- 요약을 하면 단순하고 구조로 초기 모델 실험, 해석, 그리고 교육적 목적에 매우 유용한 알고리즘이기 때문에 선정을 하게 되었습니다.
- 만약 추후에 RandomForest, GradientBoosting, XGBoost, LightGBM 등의 앙상블 기법을 함께 사용하는 것이 일반적인 확장 방향입니다. 

## 9. 기대 효과
| 기대 효과       | 설명                           |


| 🧠 조기 예측    | 갑상선암 발생 또는 재발 위험 환자 선별 가능    |

| 🩺 맞춤 의료    | 환자 특성 기반 예측으로 개인 맞춤 치료 설계 가능 |

| 💰 의료비 절감   | 불필요한 검사를 줄이고, 조기 치료로 비용 감소   |

| 🏥 의료 현장 지원 | 의료진의 의사결정을 데이터 기반으로 보조 가능    |

| 📈 공공 보건 기여 | 예방 중심의 정책 설계에 기초 자료 제공 가능    |

## 10.최종결론
## ✅ 최종 결론
본 프로젝트는 갑상선암 환자의 의료 데이터를 기반으로 **재발 여부를 예측**하기 위한 머신러닝 및 딥러닝 모델을 개발하고 평가하는 데 초점을 맞추었습니다.
### 🔍 핵심 정리:
1. **정제된 데이터 기반 예측 모델 구축**  
   - Age, Smoking, Risk, TNM 병기 등 주요 임상 데이터를 중심으로 전처리 수행  
   - 범주형 변수는 One-Hot 인코딩 처리, 수치형 변수는 표준화 적용  
   - SMOTE 등 오버샘플링 기법을 통해 클래스 불균형 문제 해결
2. **의미 있는 변수 식별**  
   - EDA 결과, `Stage`, `Response`, `Age` 등의 변수가 `Recurred`(재발 여부)와 상관관계가 높은 것으로 확인됨  
   - 히트맵 및 박스플롯을 통해 변수 간 관계 및 이상치 분포 시각화
3. **딥러닝 모델 성능 확인**  
   - 2개 은닉층(64, 32노드)과 sigmoid 출력층으로 구성된 신경망 모델 적용  
   - 훈련 정확도와 검증 정확도가 안정적으로 상승, 과적합 없이 학습됨  
   - 모델이 실제 데이터에 대해 일반화 능력을 유지하고 있음
4. **추후 발전 방향 제시**  
   - RandomForest, XGBoost 등 다양한 알고리즘과의 성능 비교 예정  
   - 하이퍼파라미터 튜닝 및 성능 시각화, 예측 결과 저장 기능 추가  
   - Flask/Streamlit 기반 웹 앱으로 확장 가능성 고려
- 본 프로젝트는 갑상선암 환자의 의료 데이터를 기반으로 재발 여부를 예측하기 위한 머신러닝 및 딥러닝 모델을 개발하고 평가하는 데 초점을 맞추었습니다.

## 11. 참고문헌
## 📚 참고문헌
[1] Géron, A. (2019). *Hands-On Machine Learning with Scikit-Learn, Keras & TensorFlow*. O’Reilly Media.
[2] Chawla, N. V., Bowyer, K. W., Hall, L. O., & Kegelmeyer, W. P. (2002). SMOTE: Synthetic Minority Over-sampling Technique. *Journal of Artificial Intelligence Research*, 16, 321–357.
[3] Scikit-learn Developers. (2024). *Decision Tree Classifier Documentation*. Retrieved from https://scikit-learn.org/stable/modules/tree.html
[4] Vizeno. (2024). *Thyroid Cancer Recurrence Prediction Dataset*. Kaggle. Retrieved from https://www.kaggle.com/code/vizeno/thyroid-cancer-prediction-recurrence-eda-ann/input
[5] François Chollet. (2021). *Deep Learning with Python* (2nd ed.). Manning Publications.
[6] 대한갑상선학회. (2022). *갑상선암 진료 가이드라인*. https://www.thyroid.or.kr
[7] National Cancer Center Korea. (2023). *암 통계 자료*. https://www.cancer.go.kr
---

  


